#!/usr/bin/env bash
sudo apt update
sudo apt upgrade -y
sudo apt install -y curl git tmux zsh openssh-client vim gh
sudo apt autoremove --purge -y
sudo apt clean -y
curl -O https://raw.githubusercontent.com/bernardoeuler/configs/main/linux/.zshenv --output-dir $HOME
source ~/.zshenv
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh) --unattended"
ZSH_CUSTOM=$ZDOTDIR/ohmyzsh/custom
git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
git clone https://github.com/MichaelAquilina/zsh-you-should-use.git $ZSH_CUSTOM/plugins/you-should-use
git clone https://github.com/asdf-vm/asdf.git $ASDF_DIR
curl -O https://raw.githubusercontent.com/bernardoeuler/configs/main/linux/.config/zsh/.zshrc --output-dir $ZDOTDIR
curl -O https://raw.githubusercontent.com/bernardoeuler/configs/main/linux/.config/zsh/.p10k.zsh --output-dir $ZDOTDIR
mkdir -p $XDG_CONFIG_HOME/tmux
curl https://raw.githubusercontent.com/bernardoeuler/configs/refs/heads/main/linux/.config/tmux/tmux.conf -o $XDG_CONFIG_HOME/tmux/tmux.conf
git clone https://github.com/tmux-plugins/tpm $XDG_DATA_HOME/tmux/plugins/tpm
$XDG_DATA_HOME/tmux/plugins/tpm/bin/install_plugins
mkdir ~/.vim
curl -O https://raw.githubusercontent.com/bernardoeuler/configs/refs/heads/main/linux/.vim/vimrc --output-dir ~/.vim
mkdir $XDG_CONFIG_HOME/git
curl -O https://raw.githubusercontent.com/bernardoeuler/configs/refs/heads/main/linux/.config/git/config --output-dir $XDG_CONFIG_HOME/git
curl -O https://raw.githubusercontent.com/bernardoeuler/configs/refs/heads/main/linux/.config/git/ignore --output-dir $XDG_CONFIG_HOME/git
echo "Generating SSH key for GitHub"
[[ -d ~/.ssh ]] || mkdir ~/.ssh
chmod 700 ~/.ssh
ssh-keygen -t rsa -f ~/.ssh/github_rsa
echo "Login into your GitHub account"
gh auth login
echo "Add permissions to GitHub CLI"
gh auth refresh -h github.com -s repo,delete_repo,user,admin:org,admin:gpg_key,admin:public_key
read -p "Choose a title for the SSH key on GitHub: " title
gh ssh-key add .ssh/github_rsa.pub --title $title
echo "SSH key registered with success\n"
echo "Change default shell to zsh"
chsh -s /usr/bin/zsh
zsh
